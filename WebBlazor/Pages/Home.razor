@page "/"
@using Service.Models
@inject IGenericService<Producto> _serviceProducto

<PageTitle>Inicio - StockCarniceria</PageTitle>

<div class="home-container">
    <!-- Encabezado Principal -->
    <div class="hero-banner">
        <h1 class="hero-title">🥩 StockCarnicería</h1>
        <p class="hero-subtitle">Plataforma de Gestión de Inventario y Ventas</p>
    </div>

    <!-- Sección de Bienvenida -->
    <div class="welcome-section">
        <h2 class="section-title">🎯 Bienvenido al Panel de Control</h2>
        <p class="section-description">
            StockCarnicería es una plataforma diseñada para gestionar de manera eficiente el inventario, control de stock, 
            y optimización de ventas de productos cárnicos. Su objetivo principal es brindar acceso rápido a las funciones 
            de gestión de productos, categorías y pedidos.
        </p>
    </div>

    <!-- Estadísticas rápidas -->
    @if (totalProductos > 0)
    {
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">📦</div>
                <div class="stat-content">
                    <h3>Productos</h3>
                    <p class="stat-number">@totalProductos</p>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">⚠️</div>
                <div class="stat-content">
                    <h3>Stock Bajo</h3>
                    <p class="stat-number">@stockBajo</p>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">💰</div>
                <div class="stat-content">
                    <h3>Valor Inventario</h3>
                    <p class="stat-number">$@valorTotal.ToString("N0")</p>
                </div>
            </div>
        </div>
    }

    <!-- Características principales -->
    <div class="features-section">
        <h3 class="section-title">✨ Características Principales</h3>
        <div class="features-grid">
            <div class="feature-card">
                <span class="feature-icon">📊</span>
                <h4>Gestión de Inventario</h4>
                <p>Controla el stock de tus productos en tiempo real.</p>
            </div>

            <div class="feature-card">
                <span class="feature-icon">🛒</span>
                <h4>Sistema de Ventas</h4>
                <p>Registra y administra tus ventas de forma rápida.</p>
            </div>

            <div class="feature-card">
                <span class="feature-icon">📦</span>
                <h4>Categorización</h4>
                <p>Organiza tus productos por categorías personalizadas.</p>
            </div>

            <div class="feature-card">
                <span class="feature-icon">🤝</span>
                <h4>Gestión de Proveedores</h4>
                <p>Mantén control sobre tus proveedores y suministros.</p>
            </div>
        </div>
    </div>

    <!-- Pie de página -->
    <div class="footer-section">
        <p class="footer-text">Plataforma educativa: Desarrollo 2do año - TSDS - 2025</p>
    </div>
</div>

@code {
    private int totalProductos = 0;
    private int stockBajo = 0;
    private decimal valorTotal = 0;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var productos = await _serviceProducto.GetAllAsync();
            if (productos != null && productos.Any())
            {
                totalProductos = productos.Count;
                stockBajo = productos.Count(p => p.Stock <= 20);
                valorTotal = productos.Sum(p => p.Stock * p.PrecioUnitario);
            }
        }
        catch (Exception ex)
        {
            // Manejar error silenciosamente
            Console.WriteLine($"Error al cargar estadísticas: {ex.Message}");
        }
    }
}